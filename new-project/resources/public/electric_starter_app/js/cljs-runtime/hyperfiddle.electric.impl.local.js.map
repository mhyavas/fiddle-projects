{"version":3,"sources":["hyperfiddle/electric/impl/local.cljc"],"mappings":"","names":[],"sourcesContent":["(ns hyperfiddle.electric.impl.local\r\n  #?(:cljs (:require-macros [hyperfiddle.electric.impl.local :refer [local get-local set-local with-local]])))\r\n\r\n(defmacro local []\r\n  (if (:js-globals &env) `(volatile! nil) `(ThreadLocal.)))\r\n\r\n(defmacro get-local [l]\r\n  (if (:js-globals &env) `(deref ~l) `(.get ~(with-meta l (assoc (meta l) :tag `ThreadLocal)))))\r\n\r\n(defmacro set-local [l x]\r\n  (if (:js-globals &env) `(vreset! ~l ~x) `(doto ~x (->> (.set ~(with-meta l (assoc (meta l) :tag `ThreadLocal)))))))\r\n\r\n(defmacro with-local [l i & body]\r\n  `(let [prev# (get-local ~l)]\r\n     (set-local ~l ~i)\r\n     (try [(do ~@body) (get-local ~l)]\r\n          (finally (set-local ~l prev#)))))\r\n"],"x_google_ignoreList":[0]}